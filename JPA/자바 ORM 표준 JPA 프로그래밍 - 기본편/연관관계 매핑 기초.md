## ì—°ê´€ê´€ê³„ê°€ í•„ìš”í•œ ì´ìœ 
![7](https://github.com/ChaewonHan/TIL/blob/0805df22d6f4e5aa7abbeca994f6f957b251f7e8/JPA/%EC%9E%90%EB%B0%94%20ORM%20%ED%91%9C%EC%A4%80%20JPA%20%ED%94%84%EB%A1%9C%EA%B7%B8%EB%9E%98%EB%B0%8D%20-%20%EA%B8%B0%EB%B3%B8%ED%8E%B8/img/7.png)

- í´ë˜ìŠ¤ì—ì„œ ì°¸ì¡° ëŒ€ì‹ ì— ì™¸ë˜í‚¤ ì‹ë³„ìë¥¼ ì§ì ‘ ë‹¤ë£¸(teamId)

```java
@Entity
public class Member {
	 @Id @GeneratedValue
	 private Long id;
	 @Column(name = "USERNAME")
	 private String name;
	 @Column(name = "TEAM_ID")
	 private Long teamId; // ì°¸ì¡°ì—†ì´ ì™¸ë˜í‚¤ ì‚¬ìš©
	 â€¦
}

@Entity
public class Team {
	 @Id @GeneratedValue
	 private Long id;
	 private String name;
	 â€¦
}
```

```java
//íŒ€ ì €ì¥
 Team team = new Team();
 team.setName("TeamA");
 em.persist(team);
 //íšŒì› ì €ì¥
 Member member = new Member();
 member.setName("member1");
 member.setTeamId(team.getId()); // DIP(ì˜ì¡´ê´€ê³„ ì—­ì „) ìœ„ë°˜!
 em.persist(member);
//ì¡°íšŒ
Member findMember = em.find(Member.class, member.getId());
//ì—°ê´€ê´€ê³„ê°€ ì—†ìŒ
Team findTeam = em.find(Team.class, team.getId());
```

- í…Œì´ë¸”
    - ì™¸ë˜í‚¤ í•˜ë‚˜ë¡œ ì–‘ìª½ ì¡°ì¸ ê°€ëŠ¥
    - ì‚¬ì‹¤ ë°©í–¥ì´ë¼ëŠ” ê°œë…ì´ ì—†ìŒ
- ê°ì²´
    - ì°¸ì¡°ìš© í•„ë“œê°€ ìˆëŠ” ìª½ìœ¼ë¡œë§Œ ì°¸ì¡° ê°€ëŠ¥
    - í•œìª½ë§Œ ì°¸ì¡°í•˜ë©´ ë‹¨ë°©í–¥
    - ì–‘ìª½ì´ ì„œë¡œ ì°¸ì¡°í•˜ë©´ ì–‘ë°©í–¥ì´ì§€ë§Œ ê°ì²´ ì…ì¥ì—ì„œëŠ” **ë‹¨ë°©í–¥ 2ê°œ**

â‡’ ì´ëŸ¬í•œ ì°¨ì´ ë•Œë¬¸ì— ê°ì²´ë¥¼ í…Œì´ë¸” ì¤‘ì‹¬ìœ¼ë¡œ ëª¨ë¸ë§í•˜ë©´ ê°ì²´ì§€í–¥ì  ì½”ë“œë¥¼ ë§Œë“¤ ìˆ˜ ì—†ìŒ 

## ë‹¨ë°©í–¥ ì—°ê´€ê´€ê³„
![8](https://github.com/ChaewonHan/TIL/blob/0805df22d6f4e5aa7abbeca994f6f957b251f7e8/JPA/%EC%9E%90%EB%B0%94%20ORM%20%ED%91%9C%EC%A4%80%20JPA%20%ED%94%84%EB%A1%9C%EA%B7%B8%EB%9E%98%EB%B0%8D%20-%20%EA%B8%B0%EB%B3%B8%ED%8E%B8/img/8.png)

- ê°ì²´ì§€í–¥ ì—°ê´€ê´€ê³„ë¥¼ ì‚¬ìš©í•¨
- ê°ì²´ì™€ í…Œì´ë¸”ì„ ORMì´ ìë™ìœ¼ë¡œ ë§¤í•‘í•¨

```java
@Entity
 public class Member {
 
	@Id @GeneratedValue
	 private Long id;
	
	 @Column(name = "USERNAME")
	 private String name;

	 @ManyToOne // í´ë˜ìŠ¤ ê¸°ì¤€ìœ¼ë¡œ ì—°ê´€ê´€ê³„ ë§¤í•‘
	 @JoinColumn(name = "TEAM_ID") // ì¡°ì¸í•  ì»¬ëŸ¼ ì´ë¦„
	 private Team team; // ì°¸ì¡° ê°ì²´
 â€¦

//ì¡°íšŒ
 Member findMember = em.find(Member.class, member.getId());
//ì°¸ì¡°ë¥¼ ì‚¬ìš©í•´ì„œ ì—°ê´€ê´€ê³„ ì¡°íšŒ
 Team findTeam = findMember.getTeam();
```

## ì–‘ë°©í–¥ ë§¤í•‘ ê´€ê³„
![9](https://github.com/ChaewonHan/TIL/blob/0805df22d6f4e5aa7abbeca994f6f957b251f7e8/JPA/%EC%9E%90%EB%B0%94%20ORM%20%ED%91%9C%EC%A4%80%20JPA%20%ED%94%84%EB%A1%9C%EA%B7%B8%EB%9E%98%EB%B0%8D%20-%20%EA%B8%B0%EB%B3%B8%ED%8E%B8/img/9.png)

- ê°ì²´ ì—°ê´€ê´€ê³„ëŠ” **ì„œë¡œ ë‹¤ë¥¸ ë‹¨ë°©í–¥ ê´€ê³„** **2ê°œ**ë¼ê³  ë³´ë©´ ë¨
    - Member â†’ Team ì—°ê´€ê´€ê³„ 1ê°œ(ë‹¨ë°©í–¥)
    - Team â†’  Member ì—°ê´€ê´€ê³„ 1ê°œ(ë‹¨ë°©í–¥)
- í…Œì´ë¸” ì—°ê´€ê´€ê³„ëŠ” ì™¸ë˜í‚¤ë¡œ ê³µìœ í•˜ëŠ” ë°©ì‹ì´ì—¬ì„œ ì–‘ë°©í–¥ì„
    - Member(TEAM_ID) â†” Team(TEAM_ID)

```java
@Entity
public class Member {

    @Id @GeneratedValue
    @Column(name = "MEMBER_ID")
    private Long id;

    @Column(name = "USERNAME")
    private String username;

    @ManyToOne
    @JoinColumn(name = "TEAM_ID")
    private Team team;
```

```java
@Entity
public class Team {

    @Id @GeneratedValue
    @Column(name = "TEAM_ID")
    private Long id;
    private String name;

    @OneToMany(mappedBy = "team") // ì½ê¸° ì „ìš©
    private List<Member> members = new ArrayList<>();
```

- ì—°ê´€ê´€ê³„ ì–´ë…¸í…Œì´ì…˜ì„ ì£¼ì…í•˜ë©´ ì•„ë˜ ì½”ë“œì²˜ëŸ¼ ì–‘ë°©í–¥ ì¡°íšŒê°€ ê°€ëŠ¥í•˜ë‹¤

```java
//ì¡°íšŒ
 Team findTeam = em.find(Team.class, team.getId());
//ì—­ë°©í–¥ ì¡°íšŒ
 int memberSize = findTeam.getMembers().size(); 
```

## ì—°ê´€ê´€ê³„ì˜ ì£¼ì¸

- DBì— ê°’ì„ ì—…ë°ì´íŠ¸í•  ì£¼ì¸ 1ê°œë¥¼ ì§€ì •í•˜ì§€ ì•Šìœ¼ë©´ ë‘ ê°ì²´ì— ê°’ì„ ë„£ì—ˆì„ ë•Œ ORMì´ ì–´ë–¤ ê°’ì„ ë„£ì–´ì•¼í• ì§€ ëª¨ë¥´ê¸° ë•Œë¬¸ì— 1ê°œëŠ” ì£¼ì¸, 1ê°œëŠ” ì½ê¸° ì „ìš©ìœ¼ë¡œ ì§€ì •í•´ì•¼í•¨
- ì–‘ë°©í–¥ ë§¤í•‘ ê·œì¹™
    - ê°ì²´ì˜ ë‘ ê´€ê³„ì¤‘ í•˜ë‚˜ë¥¼ ì—°ê´€ê´€ê³„ì˜ ì£¼ì¸ìœ¼ë¡œ ì§€ì •í•¨
    - ì—°ê´€ê´€ê³„ì˜ ì£¼ì¸ë§Œ ì™¸ë˜í‚¤ë¥¼ ê´€ë¦¬(ë“±ë¡, ìˆ˜ì •)
    - ì£¼ì¸ì´ ì•„ë‹ˆë©´ mappedBy ì†ì„±ìœ¼ë¡œ ê°’ì„ ì½ê¸°ë§Œ í•˜ë„ë¡ í•¨(ì£¼ì¸ì€ ì§€ì • X)
    - **ì™¸ë˜í‚¤ê°€ ìˆëŠ” ê³³ì„ ì£¼ì¸ì„ ì •í•˜ì**
    
    <aside>
    ğŸ“Œ ë‹¤ëŒ€ì¼, ì¼ëŒ€ë‹¤ ê´€ê³„ì—ì„  ë‹¤ ìª½ì´ ì™¸ë˜í‚¤ë¥¼ ê°–ê³  ìˆê¸° ë•Œë¬¸ì— ë‹¤ ìª½ì´ ì—°ê´€ê´€ê³„ ì£¼ì¸ì´ë‹¤. ê·¸ë˜ì„œ @ManyToOneì—ì„  mappedBy ì†ì„±ì„ ì‚¬ìš©í•  ìˆ˜ ì—†ë‹¤.
    
    </aside>
    

## ì–‘ë°©í–¥ ì—°ê´€ê´€ê³„ ì£¼ì˜ì 

- ì—°ê´€ê´€ê³„ ì£¼ì¸ì— ê°’ì„ ì…ë ¥í•´ì•¼ í•¨

```java
Team team = new Team();
 team.setName("TeamA");
 em.persist(team);

 Member member = new Member();
 member.setName("member1");

 //ì—­ë°©í–¥(ì£¼ì¸ì´ ì•„ë‹Œ ë°©í–¥)ë§Œ ì—°ê´€ê´€ê³„ ì„¤ì •
 team.getMembers().add(member);
 em.persist(member);
```

- ìˆœìˆ˜í•œ ê°ì²´ê´€ê³„ì—ì„œëŠ” ì–‘ìª½ ë‹¤ ê°’ì„ ì…ë ¥í•´ì•¼ ë˜ê¸° ë•Œë¬¸ì— ì–‘ìª½ ê°’ì„ ë‹¤ ì…ë ¥í•˜ëŠ” ê²ƒì„ ê¶Œì¥í•¨

```java
Team team = new Team();
team.setName("TeamA");
em.persist(team);
 
Member member = new Member();
member.setName("member1");
//ì—°ê´€ê´€ê³„ì˜ ì£¼ì¸ì— ê°’ ì„¤ì •
 member.setTeam(team); 
// ì–‘ìª½ ê°’ ëª¨ë‘ ì…ë ¥
team.getMembers().add(member);
em.persist(member);
```

- ì–‘ìª½ ê°’ì„ ëª¨ë‘ ì…ë ¥í•  ë•Œì—ëŠ” ì—°ê´€ê´€ê³„ í¸ì˜ ë©”ì†Œë“œë¥¼ ì‚¬ìš©í•´ì„œ ì…ë ¥í•˜ëŠ” ê²ƒì„ ê¶Œì¥í•¨
    - ê¹œë¹¡í•˜ê³  ì½”ë“œë¥¼ ì•ˆ ì ì„ ê°€ëŠ¥ì„± ë°°ì œ
    - setterë¥¼ changeë¡œ ëª…ì‹œí•˜ì—¬ ì¤‘ìš”í•œ ë©”ì„œë“œë¼ëŠ” ê²ƒì„ ì•Œë ¤ì£¼ì

```java
@Entity
public class Member {
	@ManyToOne
	@JoinColumn(name = "TEAM_ID")
	private Team team;

  public void changeTeam(Team team) { // ì—°ê´€ê´€ê³„ í¸ì˜ ë©”ì†Œë“œ
      this.team = team;
      team.getMembers().add(this); // ì–‘ìª½ ê°’ ëª¨ë‘ ì…ë ¥
  }
```

- toString(), lombok, JSON ìƒì„± ë¼ì´ë¸ŒëŸ¬ë¦¬ë¥¼ ì“¸ ë•Œ ë¬´í•œ ë£¨í”„ë¥¼ ì£¼ì˜í•˜ì

## ì •ë¦¬

- ë‹¨ë°©í–¥ ë§¤í•‘ë§Œìœ¼ë¡œë„ ì´ë¯¸ ì—°ê´€ê´€ê³„ ë§¤í•‘ì€ ì™„ì„±
- ì–‘ë°©í–¥ ë§¤í•‘ì€ ë°˜ëŒ€ ë°©í–¥ ì¡°íšŒ(ê°ì²´ ê·¸ë˜í”„ íƒìƒ‰)ì´ ì¶”ê°€ëœ ê²ƒì¼ë¿(DBì— ì˜í–¥ì„ ì£¼ì§€ ì•ŠìŒ)
- JPQLì—ì„œ ì—­ë°©í–¥ìœ¼ë¡œ íƒìƒ‰í•  ì¼ì´ ë§ì•„ì„œ ê·¸ ë•Œ ì‚¬ìš©í•¨
- ë‹¨ë°©í–¥ ë§¤í•‘ì„ ì˜í•˜ê³  ì–‘ë°©í–¥ ë§¤í•‘ì€ ê°œë°œ ë‹¨ê³„ì—ì„œ ê³ ë¯¼í•´ë„ ëŠ¦ì§€ ì•ŠìŒ
